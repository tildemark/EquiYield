(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[646],{220:(e,t,s)=>{"use strict";function a(){{let e=window.location.hostname;return"http://".concat(e,":4000")}}s.d(t,{h:()=>a})},480:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var a=s(4568),l=s(7620),r=s(7541),n=s(220);function i(){let e=(0,r.useRouter)(),[t,s]=(0,l.useState)(null),[i,c]=(0,l.useState)(null),[d,o]=(0,l.useState)(""),[x,m]=(0,l.useState)(null),[h,g]=(0,l.useState)(!1),[b,u]=(0,l.useState)(!1),[y,N]=(0,l.useState)(""),[j,p]=(0,l.useState)(""),[f,v]=(0,l.useState)(""),[w,S]=(0,l.useState)(!1),[D,A]=(0,l.useState)(!1),[L,E]=(0,l.useState)(""),[P,C]=(0,l.useState)(""),[T,k]=(0,l.useState)(null),[M,I]=(0,l.useState)(null),[O,_]=(0,l.useState)(!0),[R,B]=(0,l.useState)(!0),[z,U]=(0,l.useState)(!0),[F,V]=(0,l.useState)(!1),[G,Y]=(0,l.useState)(!0),[q,H]=(0,l.useState)([]),[J,W]=(0,l.useState)("");(0,l.useEffect)(()=>{let t=localStorage.getItem("eq_member_token");if(!t)return void e.push("/member/login");s(t)},[]),(0,l.useEffect)(()=>{t&&(async()=>{try{let e=(0,n.h)(),s=await fetch("".concat(e,"/api/member/me"),{headers:{Authorization:"Bearer ".concat(t)},cache:"no-store"}),a=await s.json();if(!s.ok)throw Error(a.error||"Failed to load profile");c(a)}catch(e){o(e.message)}})()},[t]),(0,l.useEffect)(()=>{t&&(async()=>{try{let e=(0,n.h)(),s=await fetch("".concat(e,"/api/member/dividends"),{headers:{Authorization:"Bearer ".concat(t)},cache:"no-store"}),a=await s.json();if(!s.ok)throw Error(a.error||"Failed to load payouts");H(a)}catch(e){W(e.message)}})()},[t]),(0,l.useEffect)(()=>{t&&(async()=>{try{let e=(0,n.h)(),s=await fetch("".concat(e,"/api/admin/system-config"),{headers:{Authorization:"Bearer ".concat(t)},cache:"no-store"}),a=await s.json();m(a)}catch(e){console.error("Failed to load config:",e)}})()},[t]);let K=async e=>{if(e.preventDefault(),t){A(!0);try{let e=(0,n.h)(),s=await fetch("".concat(e,"/api/member/loans"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({principal:Number(L),termMonths:Number(P)})}),a=await s.json();if(!s.ok)throw Error(a.error||"Loan application failed");E(""),C(""),S(!1);let l=await fetch("".concat(e,"/api/member/me"),{headers:{Authorization:"Bearer ".concat(t)}});c(await l.json())}catch(e){o(e.message)}finally{A(!1)}}},Q=async e=>{if(e.preventDefault(),t){u(!0),N("");try{let e=(0,n.h)(),s=await fetch("".concat(e,"/api/auth/change-password"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({currentPassword:j,newPassword:f})}),a=await s.json();if(!s.ok){let e="string"==typeof a.error?a.error:a.message||JSON.stringify(a.error)||"Change password failed";throw Error(e)}N("✓ Password updated successfully"),p(""),v(""),setTimeout(()=>g(!1),1500)}catch(e){N("✗ "+((null==e?void 0:e.message)||("string"==typeof e?e:"Change password failed. Please try again.")))}finally{u(!1)}}},X=Number(L)||0,Z=Number(P)||0,$=Math.round(.05*X*Z),ee=X+$,et=Z>0?Math.round(ee/Z):0;return t?(0,a.jsxs)("div",{className:"mx-auto max-w-5xl p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"border-b border-gray-200 pb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Member Dashboard"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("button",{className:"btn btn-secondary text-sm",onClick:()=>g(!0),children:"Change Password"}),(0,a.jsx)("button",{className:"btn btn-primary text-sm",onClick:()=>S(!0),children:"Apply for Loan"}),(0,a.jsx)("button",{className:"btn btn-secondary text-sm",onClick:()=>{localStorage.removeItem("eq_member_token"),e.push("/member/login")},children:"Sign Out"})]})]}),i&&(0,a.jsxs)("p",{className:"text-gray-600",children:["Welcome back, ",i.full_name]})]}),d&&(0,a.jsx)("div",{className:"rounded-lg border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:d}),h&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"card max-w-md w-full mx-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Change Password"}),(0,a.jsxs)("form",{className:"space-y-3",onSubmit:Q,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"Current Password"}),(0,a.jsx)("input",{className:"input",type:"password",value:j,onChange:e=>p(e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"New Password"}),(0,a.jsx)("input",{className:"input",type:"password",value:f,onChange:e=>v(e.target.value),required:!0})]}),y&&(0,a.jsx)("div",{className:"text-sm p-2 rounded ".concat(y.startsWith("✓")?"bg-green-50 text-green-700":"bg-red-50 text-red-700"),children:y}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{className:"btn btn-primary flex-1",type:"submit",disabled:b,children:b?"Updating…":"Update"}),(0,a.jsx)("button",{className:"btn btn-secondary flex-1",type:"button",onClick:()=>{g(!1),p(""),v(""),N("")},children:"Close"})]})]})]})}),w&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"card max-w-lg w-full mx-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Apply for a Loan"}),i&&i.loans.some(e=>"PENDING"===e.status)&&(0,a.jsxs)("div",{className:"mb-4 rounded-lg border border-yellow-200 bg-yellow-50 p-3",children:[(0,a.jsx)("p",{className:"text-sm text-yellow-800 font-semibold",children:"⚠️ Cannot Apply"}),(0,a.jsx)("p",{className:"text-xs text-yellow-700 mt-1",children:"You cannot apply for a new loan while you have pending loan applications."})]}),(0,a.jsxs)("form",{className:"space-y-4",onSubmit:K,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"Principal Amount (PHP)"}),(0,a.jsx)("input",{className:"input",type:"number",min:(null==x?void 0:x.min_loan_amount)||1e3,max:(null==x?void 0:x.max_loan_amount)||1e5,value:L,onChange:e=>E(e.target.value),disabled:!!(i&&i.loans.some(e=>"PENDING"===e.status)),required:!0}),(0,a.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Min: ₱",((null==x?void 0:x.min_loan_amount)||1e3).toLocaleString()," • Max: ₱",((null==x?void 0:x.max_loan_amount)||1e5).toLocaleString()]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"Term (Months)"}),(0,a.jsx)("input",{className:"input",type:"number",min:"1",max:"60",value:P,onChange:e=>C(e.target.value),disabled:!!(i&&i.loans.some(e=>"PENDING"===e.status)),required:!0}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"1 to 60 months"})]}),X>0&&Z>0&&(0,a.jsxs)("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-4 space-y-2",children:[(0,a.jsx)("h4",{className:"font-semibold text-sm text-blue-900",children:"Loan Computation"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,a.jsx)("div",{className:"text-gray-600",children:"Principal:"}),(0,a.jsxs)("div",{className:"font-semibold text-right",children:["₱",X.toLocaleString()]}),(0,a.jsx)("div",{className:"text-gray-600",children:"Interest Rate (5% p.a.):"}),(0,a.jsxs)("div",{className:"font-semibold text-right",children:["5.0","%"]}),(0,a.jsx)("div",{className:"text-gray-600",children:"Term:"}),(0,a.jsxs)("div",{className:"font-semibold text-right",children:[Z," month",1!==Z?"s":""]}),(0,a.jsx)("div",{className:"border-t border-blue-200"}),(0,a.jsx)("div",{className:"border-t border-blue-200"}),(0,a.jsx)("div",{className:"text-gray-600",children:"Total Interest:"}),(0,a.jsxs)("div",{className:"font-semibold text-right",children:["₱",$.toLocaleString()]}),(0,a.jsx)("div",{className:"text-gray-600 font-semibold",children:"Total Amount:"}),(0,a.jsxs)("div",{className:"font-bold text-right text-lg",children:["₱",ee.toLocaleString()]}),(0,a.jsx)("div",{className:"text-gray-600",children:"Monthly Amortization:"}),(0,a.jsxs)("div",{className:"font-semibold text-right",children:["₱",et.toLocaleString()]})]})]}),(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Member-applied loans are created with status PENDING and require admin approval."}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{className:"btn btn-primary flex-1",type:"submit",disabled:D||0===X||0===Z||!!(i&&i.loans.some(e=>"PENDING"===e.status)),children:D?"Submitting…":"Submit Application"}),(0,a.jsx)("button",{className:"btn btn-secondary flex-1",type:"button",onClick:()=>{S(!1),E(""),C("")},children:"Close"})]})]})]})}),T&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"card max-w-md w-full mx-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Contribution Details"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Date Paid"}),(0,a.jsx)("div",{className:"font-semibold",children:new Date(T.date_paid).toLocaleDateString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Amount"}),(0,a.jsxs)("div",{className:"font-semibold text-lg",children:["₱",T.amount.toLocaleString()]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Status"}),(0,a.jsx)("div",{className:"font-semibold",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("COMPLETED"===T.status?"bg-green-100 text-green-800":"PENDING"===T.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:T.status})})]}),T.method&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Payment Method"}),(0,a.jsx)("div",{className:"font-semibold",children:T.method})]}),T.reference_number&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Reference Number"}),(0,a.jsx)("div",{className:"font-mono text-sm",children:T.reference_number})]})]}),(0,a.jsx)("div",{className:"mt-6 flex gap-2",children:(0,a.jsx)("button",{className:"btn btn-secondary flex-1",onClick:()=>k(null),children:"Close"})})]})}),M&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"card max-w-md w-full mx-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Loan Repayment Details"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Date Applied"}),(0,a.jsx)("div",{className:"font-semibold",children:new Date(M.createdAt).toLocaleDateString()})]}),M.releasedAt&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Date Released"}),(0,a.jsx)("div",{className:"font-semibold",children:new Date(M.releasedAt).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Principal"}),(0,a.jsxs)("div",{className:"font-semibold",children:["₱",M.principal.toLocaleString()]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Interest"}),(0,a.jsxs)("div",{className:"font-semibold",children:["₱",M.interest.toLocaleString()]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Term"}),(0,a.jsxs)("div",{className:"font-semibold",children:[M.termMonths," month",1!==M.termMonths?"s":""]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Monthly Amortization"}),(0,a.jsxs)("div",{className:"font-semibold",children:["₱",M.monthlyAmortization.toLocaleString()]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Total Amount Due"}),(0,a.jsxs)("div",{className:"font-semibold text-lg",children:["₱",(M.principal+M.interest).toLocaleString()]})]}),M.termMonths&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Expected Completion Date"}),(0,a.jsxs)("div",{className:"font-semibold",children:[(()=>{let e=new Date(new Date(M.releasedAt?M.releasedAt:M.createdAt));return e.setMonth(e.getMonth()+M.termMonths),e.toLocaleDateString()})(),!M.releasedAt&&(0,a.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(from application date)"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Status"}),(0,a.jsx)("div",{className:"font-semibold",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("ACTIVE"===M.status?"bg-blue-100 text-blue-800":"APPROVED"===M.status?"bg-green-100 text-green-800":"PENDING"===M.status?"bg-yellow-100 text-yellow-800":"PAID"===M.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:"PAID"===M.status?"Settled":"ACTIVE"===M.status?"Active":M.status})})]}),M.settledAt&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Date Settled"}),(0,a.jsx)("div",{className:"font-semibold",children:new Date(M.settledAt).toLocaleDateString()})]}),M.payments&&M.payments.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-400 mb-2",children:"Payment History"}),(0,a.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:M.payments.map(e=>(0,a.jsx)("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-3",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleDateString("en-PH",{year:"numeric",month:"short",day:"numeric"})}),e.method&&(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:["Method: ",(0,a.jsx)("span",{className:"font-medium",children:e.method})]}),e.reference&&(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:["Ref: ",(0,a.jsx)("span",{className:"font-mono",children:e.reference})]})]}),(0,a.jsxs)("div",{className:"font-semibold text-green-600",children:["₱",e.amount.toLocaleString()]})]})},e.id))})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-3 text-xs text-gray-700",children:[(0,a.jsx)("p",{className:"font-semibold mb-1",children:"Note:"}),(0,a.jsx)("p",{children:"Monthly amortization is calculated based on the loan terms approved by administration."})]})]}),(0,a.jsx)("div",{className:"mt-6 flex gap-2",children:(0,a.jsx)("button",{className:"btn btn-secondary flex-1",onClick:()=>I(null),children:"Close"})})]})}),i&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"card bg-gradient-to-br from-blue-50 to-blue-100",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Account Information"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Email:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:i.email})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Phone:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:i.phone_number})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Shares:"}),(0,a.jsx)("span",{className:"font-semibold text-blue-600 text-lg",children:i.share_count})]}),i.gcashNumber&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"GCash:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:i.gcashNumber})]}),i.bankName&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Bank:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:i.bankName})]}),i.bankAccountNumber&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Account:"}),(0,a.jsx)("span",{className:"font-mono text-sm text-gray-900",children:i.bankAccountNumber})]})]})]}),(0,a.jsxs)("div",{className:"card bg-gradient-to-br from-green-50 to-green-100",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Total Contributions"}),(0,a.jsxs)("div",{className:"text-3xl font-bold text-green-700",children:["₱",i.totalContributions.toLocaleString()]}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:[i.contributions.length," payment",1!==i.contributions.length?"s":""," recorded"]})]}),i.loans.filter(e=>["ACTIVE","APPROVED","RELEASED"].includes(e.status)&&e.remainingBalance>0).length>0?(0,a.jsxs)("div",{className:"card bg-gradient-to-br from-purple-50 to-purple-100",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Active Loan Summary"}),i.loans.filter(e=>["ACTIVE","APPROVED","RELEASED"].includes(e.status)&&e.remainingBalance>0).map(e=>{let t=e.dueDate?new Date(e.dueDate):null,s=e.isPastDue;return(0,a.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Principal:"}),(0,a.jsxs)("span",{className:"font-semibold text-gray-900",children:["₱",e.principal.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Balance:"}),(0,a.jsxs)("span",{className:"font-semibold text-purple-700",children:["₱",e.remainingBalance.toLocaleString()]})]}),t&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Due Date:"}),(0,a.jsx)("span",{className:"font-semibold ".concat(s?"text-red-600":"text-green-600"),children:t.toLocaleDateString()})]}),s&&(0,a.jsx)("div",{className:"text-xs text-red-600 font-semibold mt-1",children:"⚠️ PAST DUE"})]},e.id)})]}):(0,a.jsxs)("div",{className:"card bg-gradient-to-br from-gray-50 to-gray-100",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Loan Status"}),(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"No active loans"})]})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("button",{onClick:()=>_(!O),className:"w-full flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Contributions History"}),(0,a.jsx)("span",{className:"text-2xl text-gray-500",children:O?"−":"+"})]}),O&&(0,a.jsx)(a.Fragment,{children:0===i.contributions.length?(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"No contributions recorded"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200 bg-gray-50",children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Date Paid"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Amount"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Status"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Action"})]})}),(0,a.jsx)("tbody",{children:i.contributions.map(e=>(0,a.jsxs)("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:new Date(e.date_paid).toLocaleDateString()}),(0,a.jsxs)("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:["₱",e.amount.toLocaleString()]}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,a.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-xs font-semibold ".concat("COMPLETED"===e.status?"bg-green-100 text-green-800":"PENDING"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status})}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,a.jsx)("button",{onClick:()=>k(e),className:"text-blue-600 hover:text-blue-800 font-medium",children:"View Details"})})]},e.id))})]})})})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("button",{onClick:()=>B(!R),className:"w-full flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Loans History"}),(0,a.jsx)("span",{className:"text-2xl text-gray-500",children:R?"−":"+"})]}),R&&(0,a.jsx)(a.Fragment,{children:0===i.loans.length?(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"No loans recorded"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200 bg-gray-50",children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Date Applied"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Principal"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Interest"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Total Due"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Term"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Expected Completion"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Status"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Action"})]})}),(0,a.jsx)("tbody",{children:i.loans.map(e=>{let t=null;return e.termMonths&&(t=new Date(new Date(e.releasedAt?e.releasedAt:e.createdAt))).setMonth(t.getMonth()+e.termMonths),(0,a.jsxs)("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[(0,a.jsxs)("td",{className:"px-4 py-3 text-sm text-gray-900",children:[(0,a.jsx)("div",{children:new Date(e.createdAt).toLocaleDateString()}),e.releasedAt&&(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Released: ",new Date(e.releasedAt).toLocaleDateString()]})]}),(0,a.jsxs)("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:["₱",e.principal.toLocaleString()]}),(0,a.jsxs)("td",{className:"px-4 py-3 text-sm text-gray-600",children:["₱",e.interest.toLocaleString()]}),(0,a.jsxs)("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:["₱",(e.principal+e.interest).toLocaleString()]}),(0,a.jsxs)("td",{className:"px-4 py-3 text-sm text-gray-900",children:[e.termMonths," month",1!==e.termMonths?"s":""]}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:t?(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:t.toLocaleDateString()}),e.settledAt&&(0,a.jsxs)("div",{className:"text-xs text-green-600",children:["Settled: ",new Date(e.settledAt).toLocaleDateString()]})]}):(0,a.jsx)("span",{className:"text-gray-400",children:"—"})}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,a.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-xs font-semibold ".concat("ACTIVE"===e.status?"bg-blue-100 text-blue-800":"APPROVED"===e.status?"bg-green-100 text-green-800":"PENDING"===e.status?"bg-yellow-100 text-yellow-800":"PAID"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:"PAID"===e.status?"Settled":e.status})}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,a.jsx)("button",{onClick:()=>I(e),className:"text-blue-600 hover:text-blue-800 font-medium",children:"View Details"})})]},e.id)})})]})})})]}),i.coMakerOnLoans&&i.coMakerOnLoans.length>0&&(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("button",{onClick:()=>V(!F),className:"w-full flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Co-Maker on Loans"}),(0,a.jsx)("span",{className:"text-2xl text-gray-500",children:F?"−":"+"})]}),F&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"rounded-lg border border-orange-200 bg-orange-50 p-3 mb-4",children:[(0,a.jsx)("p",{className:"text-sm text-orange-800 font-semibold",children:"⚠️ Co-Maker Responsibility"}),(0,a.jsx)("p",{className:"text-xs text-orange-700 mt-1",children:"As a co-maker, you are responsible for loan payments if the borrower defaults. Monitor payment status regularly."})]}),(0,a.jsx)("div",{className:"divide-y",children:i.coMakerOnLoans.map(e=>{var t;let s=e.loan,l=s.user,r=(null==(t=s.payments)?void 0:t.reduce((e,t)=>e+t.amount,0))||0,n=s.principal+s.interest-r,i=s.monthlyAmortization||0,c=s.termMonths||0,d=s.releasedAt?new Date(s.releasedAt):null,o=0,x=0,m=!1,h=null;if(d&&c>0&&i>0){let e=r;for(let t=0;t<c;t++){let s=new Date(d.getFullYear(),d.getMonth()+t+1,d.getDate()),a=s<new Date;if(e>=i)e-=i;else if(a)o+=i-e,x++,e=0;else if(!h){h=s;break}}m=x>=2}return(0,a.jsxs)("div",{className:"p-4 border-b last:border-b-0 ".concat(m?"bg-red-50 border-red-200":o>0?"bg-yellow-50 border-yellow-200":""),children:[m&&(0,a.jsxs)("div",{className:"mb-3 rounded-lg border border-red-300 bg-red-100 p-2",children:[(0,a.jsx)("p",{className:"text-sm text-red-800 font-bold",children:"\uD83D\uDEA8 LOAN DEFAULTED"}),(0,a.jsxs)("p",{className:"text-xs text-red-700 mt-1",children:["Borrower is ",x," months behind. As co-maker, you may be contacted to settle this loan."]})]}),!m&&o>0&&(0,a.jsxs)("div",{className:"mb-3 rounded-lg border border-yellow-300 bg-yellow-100 p-2",children:[(0,a.jsx)("p",{className:"text-sm text-yellow-800 font-semibold",children:"⚠️ Payment Overdue"}),(0,a.jsxs)("p",{className:"text-xs text-yellow-700 mt-1",children:[x," month(s) overdue. Total overdue: ₱",o.toLocaleString(),". Please follow up with borrower."]})]}),(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-semibold text-gray-900",children:["Loan #",s.id]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["Borrower: ",(null==l?void 0:l.full_name)||s.borrowerName]}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:(null==l?void 0:l.email)||s.borrowerEmail})]}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold ".concat("PAID"===s.status?"bg-green-100 text-green-800":m?"bg-red-100 text-red-800":o>0?"bg-yellow-100 text-yellow-800":"ACTIVE"===s.status||"RELEASED"===s.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:m?"DEFAULTED":s.status})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Monthly Payment"}),(0,a.jsxs)("div",{className:"font-semibold text-gray-900",children:["₱",i.toLocaleString()]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Total Paid"}),(0,a.jsxs)("div",{className:"font-semibold text-green-600",children:["₱",r.toLocaleString()]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Remaining Balance"}),(0,a.jsxs)("div",{className:"font-semibold text-orange-600",children:["₱",n.toLocaleString()]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-500",children:o>0?"Overdue Amount":"Next Due Date"}),(0,a.jsx)("div",{className:"font-semibold ".concat(o>0?"text-red-600":"text-gray-900"),children:o>0?"₱".concat(o.toLocaleString()):h?h.toLocaleDateString():"—"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[(0,a.jsxs)("div",{className:"bg-white rounded p-2 text-center",children:[(0,a.jsx)("div",{className:"text-gray-500",children:"Payment Status"}),(0,a.jsx)("div",{className:"font-semibold mt-1 ".concat(m?"text-red-600":o>0?"text-yellow-600":"text-green-600"),children:m?"DEFAULTED":o>0?"OVERDUE":"UP TO DATE"})]}),(0,a.jsxs)("div",{className:"bg-white rounded p-2 text-center",children:[(0,a.jsx)("div",{className:"text-gray-500",children:"Term Progress"}),(0,a.jsx)("div",{className:"font-semibold mt-1 text-gray-900",children:c>0?"".concat(Math.min(Math.floor(r/i),c),"/").concat(c," months"):"—"})]}),(0,a.jsxs)("div",{className:"bg-white rounded p-2 text-center",children:[(0,a.jsx)("div",{className:"text-gray-500",children:"Released Date"}),(0,a.jsx)("div",{className:"font-semibold mt-1 text-gray-900",children:d?d.toLocaleDateString():"—"})]})]})]},e.id)})})]})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("button",{onClick:()=>Y(!G),className:"w-full flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"All Transactions (Ledger)"}),(0,a.jsx)("span",{className:"text-2xl text-gray-500",children:G?"−":"+"})]}),G&&(0,a.jsx)("div",{className:"overflow-x-auto",children:(()=>{let e=[];i.contributions.forEach(t=>{e.push({date:new Date(t.date_paid),dateStr:t.date_paid,type:"CONTRIBUTION",description:"Contribution Payment",debit:0,credit:t.amount,balance:0,reference:t.id.toString(),method:"Payment"})}),i.loans.forEach(t=>{let s=new Date(t.releasedAt?t.releasedAt:t.createdAt);e.push({date:s,dateStr:t.releasedAt||t.createdAt,type:"LOAN_DISBURSEMENT",description:"Loan #".concat(t.id," Disbursement"),debit:t.principal,credit:0,balance:0,reference:"LOAN-".concat(t.id)}),(t.payments||[]).forEach(s=>{e.push({date:new Date(s.createdAt),dateStr:s.createdAt,type:"LOAN_PAYMENT",description:"Loan #".concat(t.id," Payment"),debit:0,credit:s.amount,balance:0,reference:"LOAN-".concat(t.id)})})}),e.sort((e,t)=>e.date.getTime()-t.date.getTime());let t=0;return(e.forEach(e=>{"CONTRIBUTION"===e.type||"LOAN_PAYMENT"===e.type?t+=e.credit:"LOAN_DISBURSEMENT"===e.type&&(t-=e.debit),e.balance=t}),0===e.length)?(0,a.jsx)("p",{className:"text-gray-400",children:"No transactions found"}):(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200 bg-gray-50",children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Date"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Description"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Method/Ref"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-900",children:"Debit"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-900",children:"Credit"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-900",children:"Balance"})]})}),(0,a.jsx)("tbody",{children:e.map((e,t)=>(0,a.jsxs)("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-xs text-gray-900",children:new Date(e.dateStr).toLocaleDateString("en-PH",{year:"numeric",month:"short",day:"numeric"})}),(0,a.jsxs)("td",{className:"px-4 py-3",children:[(0,a.jsx)("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-semibold mr-2 ".concat("CONTRIBUTION"===e.type?"bg-green-100 text-green-800":"LOAN_PAYMENT"===e.type?"bg-blue-100 text-blue-800":"bg-orange-100 text-orange-800"),children:"CONTRIBUTION"===e.type?"CONTRIB":"LOAN_PAYMENT"===e.type?"PAYMENT":"DISBURSEMENT"}),(0,a.jsx)("span",{className:"text-gray-900",children:e.description})]}),(0,a.jsxs)("td",{className:"px-4 py-3 text-xs text-gray-500",children:[e.method&&(0,a.jsx)("div",{children:e.method}),e.reference&&(0,a.jsx)("div",{className:"font-mono",children:e.reference})]}),(0,a.jsx)("td",{className:"px-4 py-3 text-right font-mono",children:e.debit>0?(0,a.jsxs)("span",{className:"text-red-600 font-semibold",children:["₱",e.debit.toLocaleString()]}):(0,a.jsx)("span",{className:"text-gray-400",children:"—"})}),(0,a.jsx)("td",{className:"px-4 py-3 text-right font-mono",children:e.credit>0?(0,a.jsxs)("span",{className:"text-green-600 font-semibold",children:["₱",e.credit.toLocaleString()]}):(0,a.jsx)("span",{className:"text-gray-400",children:"—"})}),(0,a.jsxs)("td",{className:"px-4 py-3 text-right font-mono font-semibold text-gray-900",children:["₱",e.balance.toLocaleString()]})]},t))})]})})()})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("button",{onClick:()=>U(!z),className:"w-full flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Dividend Payouts"}),(0,a.jsx)("span",{className:"text-2xl text-gray-500",children:z?"−":"+"})]}),z&&(0,a.jsxs)(a.Fragment,{children:[J&&(0,a.jsx)("div",{className:"text-sm text-red-600 mb-3",children:J}),0===q.length?(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"No payouts recorded"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200 bg-gray-50",children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Year"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Per Share"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Shares"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Amount"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Channel"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Destination"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Date"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Reference"})]})}),(0,a.jsx)("tbody",{children:q.map(e=>(0,a.jsxs)("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:e.year}),(0,a.jsxs)("td",{className:"px-4 py-3 text-sm text-gray-900",children:["₱",e.perShare.toLocaleString(void 0,{maximumFractionDigits:2})]}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.sharesCount}),(0,a.jsxs)("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:["₱",e.amount.toLocaleString()]}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,a.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-xs font-semibold ".concat("GCASH"===e.channel?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"),children:e.channel})}),(0,a.jsx)("td",{className:"px-4 py-3 text-xs text-gray-600",children:"BANK"===e.channel?"".concat(e.bankName||""," ").concat(e.bankAccountNumber||""):e.gcashNumber||""}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:new Date(e.depositedAt).toLocaleDateString()}),(0,a.jsx)("td",{className:"px-4 py-3 text-xs text-gray-500 font-mono",children:e.reference||"—"})]},e.id))})]})})]})]})]})]}):null}},4902:(e,t,s)=>{Promise.resolve().then(s.bind(s,480))},7541:(e,t,s)=>{"use strict";var a=s(3041);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})}},e=>{e.O(0,[587,18,358],()=>e(e.s=4902)),_N_E=e.O()}]);